{% load static %}
{% load i18n %}
<head>
    <title class"center-align">Squirrel Wallet</title>
    <meta meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- CSS Styles -->
    <link href="{% static 'css/material-icons.css' %}" rel="stylesheet">
    <link href="{% static 'css/fontawesome/fontawesome-all.css' %}" rel="stylesheet">
    <link href="{% static 'css/roboto.css' %}" rel="stylesheet">
    <link href="{% static 'css/lato.css' %}" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/materialize.css' %}"  media="screen,projection"/>
    <link href="{% static 'css/header.css' %}" rel="stylesheet">
    <link rel="shortcut icon" type="image/png" href="{% static 'images/wallet-solid.ico' %}"/>
    <link href="{% static 'css/slick.css' %}" rel="stylesheet" type="text/css"/>
    <link href="{% static 'css/datatables.css' %}" rel="stylesheet" type="text/css"/>
    <!--<link href="{% static 'css/highcharts.css' %}" rel="stylesheet">-->

    <!-- Javascript -->
    <script src="{% static 'js/jquery.min.js' %}"></script>
    <script src="{% static 'js/materialize.js' %}"></script>
    <script src="{% static 'js/materialize-validation.min.js' %}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
    <!--<script src="{% static 'js/highcharts.js' %}"></script>
    <script src="{% static 'js/modules/stock.js' %}"></script>-->
    <script src="{% static 'js/slick.min.js' %}"></script>
    <script src="{% static 'js/header.js' %}"></script>
    <script src="{% static 'js/datatables.min.js' %}"></script>

    <!--            -->
</head>
<nav>
    <div class="nav-wrapper z-depth-1 blue darken-4">
    <div class="container">
    <a href="{% url 'dashboard' %}" class="brand-logo">&nbsp;<i class="material-icons left">account_balance_wallet</i>Squirrel Wallet</a>
    <a href="#" data-target="mobile-demo" class="sidenav-trigger"><i class="material-icons">menu</i></a>
    <ul class="right hide-on-med-and-down">
      {% if user.is_authenticated %}
        <!--<li><a class="tooltipped" data-position="bottom" data-tooltip="{% trans 'Settings' %}" href="{% url 'settings' user.pk %}"><img src='/static/avatar/{{ user.id }}' alt="{{ user.get_short_name }}" class="circle" style="max-width:30px; max-height: 30px;"/></a></li>-->
        <!--<li><a class="tooltipped" data-position="bottom" data-tooltip="{% trans 'Profile' %}" href="{% url 'profile' user.pk %}"><i class="material-icons">account_box</i></a></li>-->
        <li><a class="tooltipped" data-position="bottom" data-tooltip="{% trans 'Settings' %}" href="{% url 'settings' user.pk %}"><i class="material-icons">settings</i></a></li>
        <li><a class="tooltipped" data-position="bottom" data-tooltip="{% trans 'Contacts' %}" href="#!"><i class="material-icons">contacts</i></a></li>
        {% if has_wallet %}
        <li><a class="tooltipped" data-position="bottom" data-tooltip="{% trans 'Wallet' %}" href="{% url 'wallet' %}"><i class="material-icons">account_balance</i></a></li>
      {% else %}
        <li disabled><a href="#cwmodal" class="tooltipped modal-trigger" data-position="bottom" data-tooltip="{% trans 'Create a wallet' %}"><i class="material-icons">account_balance</i></a></li>
      {% endif %}
        <li><a class="tooltipped modal-trigger" data-position="bottom" data-tooltip="{% trans 'Activity' %}" href="#activitymodal"><i class="material-icons"><i class="material-icons">restore</i>t</i></a></li>
        <li><a class="tooltipped modal-trigger" data-position="bottom" data-tooltip="{% trans 'Logout' %}" href="#logoutmodal"><i class="material-icons">power_settings_new</i></a></li>&nbsp;
      {% else %}
        <li><a class="tooltipped" data-position="bottom" data-tooltip="{% trans 'Login' %}" href="{% url 'login' %}"><i class="material-icons">input</i></a></li>
        <li><a class="tooltipped" data-position="bottom" data-tooltip="{% trans 'Sign up' %}" href="{% url 'registration_register' %}"><i class="material-icons">people</i></a></li>
      {% endif %}
    </ul>
    <ul class="sidenav amber accent-4" id="mobile-demo">
      <div class="section amber darken-1">
        <li><a href="{% url 'dashboard' %}" class="waves-effect waves-light"><i class="material-icons">home</i>Dashboard</a></li>
        {% if has_wallet %}
          <li><a href="{% url 'wallet' %}" class="waves-effect waves-light"><i class="material-icons">account_balance</i>Wallet</a></li>
        {% else %}
          <li><a class="waves-effect waves-light"><i class="material-icons">account_balance</i>Create your wallet</a></li>
        {% endif %}
          <li><a href="{% url 'settings' user.pk %}" class="waves-effect waves-light"><i class="material-icons">account_box</i>Settings</a></li>
          <li><a href="{% url 'activity' %}" class="waves-effect waves-light"><i class="material-icons">restore</i>Activity</a></li>
          <li><a href="{% url 'auth_logout' %}" class="waves-effect waves-light"><i class="material-icons">power_settings_new</i>Log out</a></li>
      </div>
    </ul>
    </div>
    </div>
</nav>
<body class="grey lighten-2">
  <div id="home" class="row col s12 m12 l12">
    {% block content %}
    {% endblock %}
  </div>
  {% if user.is_authenticated %}
    <div class="fixed-action-btn">
      <a class="btn-floating btn-large red accent-2"><i class="large material-icons">account_balance_wallet</i></a>
      <ul>
        {% if has_btc %}
          <li><a href="#transaction" class="btn-floating amber accent-2 modal-trigger tooltipped" data-position="left" data-tooltip="{% trans 'Send bitcoins' %}"><i class="fab fa-btc"></i></a></li>
        {% else %}
          <li><a class="btn-floating amber accent-2 modal-trigger tooltipped createwallet" data-position="left" data-tooltip="{% trans 'New bitcoin wallet' %}" data-url="{% url 'createwallet' %}"><i class="fab fa-btc"></i></a></li>
        {% endif %}
        {% if has_tx %}
            <li><a href="#transactions" class="btn-floating purple tooltipped" data-position="left" data-tooltip="{% trans 'Transactions' %}" ><i class="material-icons">list</i></a></li>
        {% endif %}
      </ul>
    </div>
    {% include 'transactions.html' %}
  {% endif %}
  <div id="cwmodal" class="modal modal-fixed-footer">
      <div class="section">
        <div class="modal-content row">
            <div class="row">
                <div class="center col s12 m12 l12">
                  <i class="amber-text fab fa-btc fa-10x"></i>
                </div>
            </div>
            <div class="row">
                <div class="center col s12 m12 l12">
                  <button class="waves-effect waves-light btn btn-large amber accent-2 createwallet" data-url="{% url 'createwallet' %}">Create bitcoin wallet</button>
                </div>
            </div>
        </div>
      </div>
  </div>
  <div id="logoutmodal" class="modal">
      <div class="section">
          <div class="modal-content">
              <h3>Logging out</h3>
              <p>Are you sure you want to log out?</p>
          </div>
      </div>
      <div class="modal-footer">
          <a class="modal-close waves-effect waves-green btn grey white-text">No</a>
          <a href="{% url 'auth_logout' %}" class="modal-close waves-effect waves-green btn red white-text">Yes</a>
      </div>
  </div>
  <div id="activitymodal" class="modal bottom-sheet">
      <div class="modal-content">
          <div class="row">
              <div class="col l6">
                  <h2 class="red-text text-accent-2 center-align">Activity</h2>
                  <table class="table highlight responsive-table centered">
                      <thead>
                      <tr>
                          <th>{% trans 'Activity ID' %}</th>
                          <th>{% trans 'Description' %}</th>
                          <th>{% trans 'Date' %}</th>
                      </tr>
                      </thead>
                      <tbody>
                      {% for op in activity.operations %}
                      <tr>
                          <td>{{ op.id }}</td>
                          {% if op.type == "Pass" %}
                          <td>{% trans 'Password changed' %}</td>
                          {% elif op.type == 'Security' %}
                          <td>{% trans '2-pass configured' %}</td>
                          {% elif op.type == 'TXBTC' or op.type == 'BTCTX' %}
                          <td>{% trans 'Bitcoin transaction' %}</td>
                          {% elif op.type == 'ETHTX' or op.type == 'TXETH' %}
                          <td>{% trans 'Ethereum transaction' %}</td>
                          {% else %}
                          <td>{% trans 'Updated profile' %}</td>
                          {% endif %}
                          <td>{{ op.created_at }}</td>
                      </tr>
                      {% endfor %}
                      </tbody>
                  </table>
              </div>
              <div class="col l6">
                  <h2 class="red-text text-accent-2 center-align">Transactions</h2>
                  {% if activity.transactions %}
                      <table class="table highlight responsive-table centered">
                          <thead>
                          <tr>
                              <th>{% trans 'Transaction ID' %}</th>
                              <th>{% trans 'Description' %}</th>
                              <th>{% trans 'Type' %}</th>
                              <th>{% trans 'Amount' %}</th>
                              <th>{% trans 'Date' %}</th>
                              <th>{% trans 'Info' %}</th>
                          </tr>
                          </thead>
                          <tbody>
                          {% for op in activity.transactions %}
                          <tr>
                              <td>{{ op.txid|truncatechars:30 }}</span></td>
                              {% if op.gas %}
                              <td>{% trans 'Ethereum transaction' %}</td>
                              {% else %}
                              <td>{% trans 'Bitcoin transaction' %}</td>
                              {% endif %}
                              {% if op.type == 'IN' %}
                              <td><span class="white-text badge green">IN</span></td>
                              {% else %}
                              <td><span class="white-text badge red">OUT</span></td>
                              {% endif %}
                              <td>{{ op.amount|floatformat:3 }}</td>
                              <td>{{ op.created_at }}</td>
                              {% if op.gas %}
                              <td><a href="{% url 'detail_ether' op.txid %}"<i class="material-icons">info</i></a></td>
                              {% else %}
                              <td><a href="{% url 'detail_bitcoin' op.txid %}"<i class="material-icons">info</i></a></td>
                              {% endif %}
                          </tr>
                          {% endfor %}
                          </tbody>
                      </table>
                  {% endif %}
              </div>
          </div>
      </div>
  </div>
</body>
